---
import { getCollection } from 'astro:content';
import Base from '#layouts/Base.astro';
import PersonCard from '#components/PersonCard.astro';

const peopleCurrent = await getCollection('people', (person) => person.data.type === 'member');
const peopleFormer = await getCollection('people', (person) => person.data.type === 'former');

// Sort by priority first (lower numbers appear first), then alphabetically by name
[peopleCurrent, peopleFormer].forEach((people) => people.sort((a, b) => {
    if (a.data.priority !== b.data.priority) {
        return (a.data.priority ?? Infinity) - (b.data.priority ?? Infinity);
    }

    return a.data.name.localeCompare(b.data.name);
}));
---
<Base title="People">
    <section>
        <h2 class="heading-2">Current members</h2>
        <div class="xs:grid-cols-2 grid grid-cols-1 justify-items-center gap-6 sm:grid-cols-3 md:grid-cols-4">
            {
                peopleCurrent.map((person) => (
                    <PersonCard person={person} />
                ))
            }
        </div>
    </section>

    <section>
        <h2 class="heading-2">Former members</h2>
        <div class="xs:grid-cols-2 grid grid-cols-1 justify-items-center gap-6 sm:grid-cols-3 md:grid-cols-4">
            {
                peopleFormer.map((person) => (
                    <PersonCard person={person} />
                ))
            }
        </div>
    </section>
</Base>
